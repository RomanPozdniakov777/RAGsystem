# RAG Система

Система вопросов-ответов на основе документов с использованием Retrieval-Augmented Generation.
Позволяет задавать вопросы на русском языке и получать ответы, основанные на документации.

## Структура проекта

RAG/

├── rag_setup.py # Подготовка данных и индексация

├── rag_retriever.py # Поиск релевантных документов

├── rag_generator.py # Генерация ответов

├── rag_main.py # Главный файл запуска

├── telegram_bot.py # Telegram-бот (опционально)

├── requirements.txt # Зависимости

├── README.md # Эта инструкция

├── documents/ # Папка с вашими PDF документами

├── chroma_db/ # Векторная база данных (создается автоматически)

└── logs/ # Логи работы системы (создаются автоматически)

## Установка

1.  **Создайте виртуальное окружение:**
    ```bash
    python -m venv .venv
    # Активируйте его:
    # Windows:
    .venv\Scripts\activate
    # Linux/Mac:
    # source .venv/bin/activate
    ```

2.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
    Основные зависимости: `transformers`, `torch`, `chromadb`, `sentence-transformers`, `PyPDF2`, `accelerate`, `python-telegram-bot`, `python-dotenv`.

## Подготовка данных

1.  **Поместите PDF-документы** с документацией Python в папку `documents/`.
    Система будет обрабатывать все файлы с расширением `.pdf` в этой папке.

## Запуск

1.  **Запустите систему:**
    ```bash
    python rag_main.py
    ```

2.  **Первый запуск:**
    *   Система автоматически обнаружит PDF-файлы в папке `documents/`.
    *   Выполнит **полную настройку (setup)**:
        *   Чтение всех PDF-файлов.
        *   Разбиение текста на фрагменты (чанки) с перекрытием.
        *   Создание векторных представлений (эмбеддингов) для каждого чанка.
        *   Сохранение чанков и эмбеддингов в векторную базу данных ChromaDB (`chroma_db/`).
    *   Это может занять несколько минут в зависимости от количества документов. Из логов было видно, что обработка 27 документов занимает около 30 секунд.
    *   Модель для создания эмбеддингов (`sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2`) будет загружена при первом запуске.  
    *   Модель генерации (`Qwen/Qwen3-0.6B`) будет автоматически загружена при первом запросе (требуется интернет).

3.  **Последующие запуски:**
    *   Индексация пропускается, если папка `chroma_db/` уже существует.
    *   Запуск происходит быстрее.

4.  **Интерактивный режим:**
    *   После настройки система перейдет в режим ожидания вопросов.
    *   Введите ваш вопрос на **русском языке** в консоли и нажмите Enter.
    *   Система:
        *   Найдет релевантную информацию в векторной базе.
        *   Сгенерирует ответ на основе найденных фрагментов.
    *   Для выхода введите `выход` или `exit`.

## Запуск Telegram-бота (опционально)

1.  **Создайте Telegram-бота:**
    *   Напишите в Telegram боту [@BotFather](https://t.me/BotFather).
    *   Используйте команду `/newbot`.
    *   Следуйте инструкциям, чтобы получить **токен**.

2.  **Создайте файл `.env`:**
    *   В корне проекта создайте файл с именем `.env`.
    *   Добавьте в него токен:
      ```
      TELEGRAM_BOT_TOKEN=ВАШ_ТОКЕН_ОТ_BOTFATHER
      ```

3.  **Запустите бота:**
    ```bash
    python telegram_bot.py
    ```
    *   Бот будет работать до тех пор, пока скрипт не будет остановлен (Ctrl+C).
    *   Найдите своего бота в Telegram по имени пользователя (@username), которое вы дали при создании.
    *   Начните диалог с команды `/start`.

## Примечания

*   **GPU/CPU:** Система автоматически использует GPU (CUDA), если она доступна. В противном случае работает на CPU (может быть медленнее, особенно генерация).
*   **Модели:**
    *   Модель для **эмбеддингов**: `sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2` (загружается автоматически, multilingual).
    *   Модель для **генерации**: `Qwen/Qwen3-0.6B` (загружается автоматически при первом запросе).
*   **Интернет:** Требуется подключение к интернету для первой загрузки моделей и токенизаторов.
*   **Предупреждения (Warnings):**
    *   `symlinks`: На Windows вы можете видеть предупреждение о symlinks в кэше Hugging Face. Это не критично и связано с ограничениями файловой системы Windows ([подробнее](https://huggingface.co/docs/huggingface_hub/how-to-cache#limitations)). Чтобы убрать предупреждение, можно активировать Developer Mode в Windows.
    *   `telemetry`: ChromaDB может сообщать анонимную телеметрию ([подробнее](https://docs.trychroma.com/telemetry)).
    *   `FutureWarning`: Предупреждения от библиотек `torch` и `transformers` о deprecated функциях. Не влияют на работу.
